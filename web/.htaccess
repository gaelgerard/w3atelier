# =====================================
# SECURITY HARDENING – Bedrock / WordPress
# =====================================

# Désactiver l’indexation des dossiers
Options -Indexes

# Masquer la signature serveur
ServerSignature Off

# =====================================
# Protection fichiers & dossiers sensibles
# =====================================

<IfModule mod_rewrite.c>
  RewriteEngine On

  # Bloquer accès aux fichiers cachés
  RewriteRule (^|/)\. - [F]

  # Bloquer accès .git / .svn / .hg
  RewriteRule (^|/)\.(git|svn|hg) - [F,L]

  # Bloquer accès fichiers sensibles
  RewriteRule ^(\.env|\.user\.ini|wp-config\.php|composer\.(json|lock)|package\.(json|lock)|yarn\.lock|debug\.log) - [F,L]

  # Bloquer accès aux fichiers système
  RewriteRule ^(readme\.html|license\.txt) - [F,L]
</IfModule>

# =====================================
# Sécurité headers HTTP (si autorisés)
# =====================================
<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-XSS-Protection "1; mode=block"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>


# =====================================
# SEO Redirects
# =====================================
Include ../config/redirects.conf


# BEGIN WordPress
# Les directives (lignes) entre « BEGIN WordPress » et « END WordPress » sont générées
# dynamiquement, et doivent être modifiées uniquement via les filtres WordPress.
# Toute modification des directives situées entre ces marqueurs sera surchargée.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress

